<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3c.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:c="http://java.sun.com/jsp/jstl/core">
    <h:head>
        <title>Costing Info</title>
         <style type="text/css">
            .ui-layout-center {                    
                overflow: hidden !important;
            }

            .ui-layout-center .ui-layout-unit-content {
                overflow:hidden !important;
            }   
            .ui-dialog {
                position:absolute;
                }
        </style>
    </h:head>
    <h:body>
    <ui:composition template="/template/admin/commonLayout.xhtml">
    <ui:define name="content">
      <div class="content-bg clear-both">
      <div class="lt-flap">
            <img src="images/left.png" alt="" />
    </div>
    <div class="flap-mid">
            <div class="black-shade">&#160;</div>
    </div>
    <div class="rt-flap">
            <img src="images/right.png" alt="" />
    </div>
    
      <div class="mid-contentAdmin">
          <h:form id="frm" prependId="false">
       
      <p:layout style="height: 800px">
     
          <p:layoutUnit position="west" size="200"> 
          
        <p:menu style="text-align: center; font-size: 15; font-family: Century Gothic;" model="#{costManagedBean.model}" />
           
      </p:layoutUnit> 
          <p:layoutUnit style="text-align: center; font-variant: small-caps;  font-size: 18; font-family: Century Gothic;" position="center" header="#{costManagedBean.stypecode}"> 
            
            <p:panel rendered="#{costManagedBean.stypecode == 'Venue'}">
            <p:dataTable  style="text-align: center; font-size: 13px; font-family: Century Gothic;" paginator="true" rows="3" id="tblDetailsV" var="srv" value="#{costManagedBean.spDetails.entrySet().toArray()}">                
            <p:column headerText="Venue">
                <h:outputText  value="#{srv.key.venueName}" />  
            </p:column>  
                <p:column headerText="Venue Type">
                <h:outputText  value="#{srv.key.venueTypeId.venueType}" />  
            </p:column> 
            <p:column headerText="Package Details">  
                <p:commandButton value="Show"  action="#{costManagedBean.showVenuePkg(srv.key)}" update=":frm:pkPanelV" />
            </p:column>              
            </p:dataTable>
                <br />
              <br />
              
                  <p:dataTable id="pkPanelV" style="text-align: center; font-size: 13px; font-family: Century Gothic;" var="pkg" value="#{costManagedBean.pkgDtls}">
                      <f:facet name="header">  
                           <h:outputText value="Package Details -- #{costManagedBean.selProv}" />
                       </f:facet>
                    <c:set var="index" value="#{pkg.packageId}" />
                     <p:column headerText="Package Id">  
                        <h:outputText value="#{index}" />
                     </p:column>
                     <p:column headerText="Package Name">  
                        <h:outputText value="#{pkg.packageName}" />  
                    </p:column>
                     <p:column headerText="Unit Of Cost">  
                        <h:outputText value="#{pkg.unitOfCost.unitCostType}" />  
                    </p:column>
                     <p:column headerText="Vendor Cost">  
                        <h:outputText value="#{pkg.cost}" />  
                    </p:column>                    
                    <p:column  headerText="Negotiated Cost"> 
                            <p:inplace  editor="true">                       
                            <p:inputText  id="ncostV" size="5" value="#{costManagedBean.negotiatedCostV[index]}" label="a" />  
                            </p:inplace>                        
                    </p:column>
                     <p:column headerText="Customer Discount">  
                         <p:inplace  editor="true">                          
                         <h:inputText id="disV" size="5" value="#{costManagedBean.customerDiscountV[index]}" /> 
                         <p:ajax event="save" update=":frm:pkPanelV" listener="#{costManagedBean.setFinalAmountV(pkg.packageId,pkg.cost,costManagedBean.customerDiscountV[index])}"/>
                         </p:inplace>
                    </p:column>
                     <p:column> 
                          <f:facet  name="header">
                           Final <br /> Amount <br /> Displayed
                           </f:facet>
                          
                         <h:outputText id="fmdV" value="#{costManagedBean.finalAmountV[index]}" />
                         
                    </p:column>
                    <p:column headerText="Save">  
                        <p:commandButton  icon="ui-icon-disk" oncomplete="msgDlg.show()" update=":frm:pkPanelV" action="#{costManagedBean.addVenueCostDtls(pkg.packageId,pkg.cost)}" />                         
                    </p:column>
                </p:dataTable> 
              
            </p:panel>
            
            <p:panel rendered="#{costManagedBean.stypecode != 'Venue'}">
            <p:dataTable  style="text-align: center; font-size: 13px; font-family: Century Gothic;" paginator="true" rows="3" id="tblDetails" var="srv" value="#{costManagedBean.spDetails.entrySet().toArray()}">                
            <p:column headerText="Provider Name">  
                <h:outputText  value="#{srv.key.serviceProviderName}" />
            </p:column>  

            <p:column headerText="Package Details">  
                <p:commandButton value="Show"  action="#{costManagedBean.showPkg(srv.key)}" update=":frm:pkPanel" />
            </p:column>              
            </p:dataTable>
            
              <br />
              <br />
              
                  <p:dataTable id="pkPanel" style="text-align: center; font-size: 13px; font-family: Century Gothic;" var="pkg" value="#{costManagedBean.pkgDtls}">
                       <f:facet name="header">  
                           <h:outputText value="Package Details -- #{costManagedBean.selProv}" />
                       </f:facet>
                    <c:set var="index" value="#{pkg.packageId}" />
                     <p:column headerText="Package Id">  
                        <h:outputText value="#{index}" />
                     </p:column>
                     <p:column headerText="Package Name">  
                        <h:outputText value="#{pkg.packageName}" />  
                    </p:column>
                     <p:column headerText="Unit Of Cost">  
                        <h:outputText value="#{pkg.unitOfCost.unitCostType}" />  
                    </p:column>
                     <p:column headerText="Vendor Cost">  
                        <h:outputText value="#{pkg.cost}" />  
                    </p:column>                    
                    <p:column  headerText="Negotiated Cost"> 
                            <p:inplace  editor="true">                       
                            <p:inputText  id="ncost" size="5" value="#{costManagedBean.negotiatedCost[index]}" label="a" />  
                            </p:inplace>                        
                    </p:column>
                     <p:column headerText="Customer Discount">  
                         <p:inplace  editor="true">                          
                         <h:inputText id="dis" size="5" value="#{costManagedBean.customerDiscount[index]}" /> 
                         <p:ajax event="save" update=":frm:pkPanel" listener="#{costManagedBean.setFinalAmount(pkg.packageId,pkg.cost,costManagedBean.customerDiscount[index])}"/>
                         </p:inplace>
                    </p:column>
                     <p:column> 
                          <f:facet  name="header">
                           Final <br /> Amount <br /> Displayed
                           </f:facet>
                          
                         <h:outputText id="fmd" value="#{costManagedBean.finalAmount[index]}" />
                         
                    </p:column>
                    <p:column headerText="Save">                          
                          <p:commandButton icon="ui-icon-disk" oncomplete="msgDlg.show()" update=":frm:pkPanel" action="#{costManagedBean.addCostDtls(pkg.packageId,pkg.cost)}" />                       
                    </p:column>
                </p:dataTable> 
              
              <p:dialog appendToBody="true" style="position: center; font-size: 15px" id="msgDlg"  widgetVar="msgDlg">  
                    <h:outputText value="Package Details saved!" />                   
              </p:dialog>
              </p:panel>
              
              <p:outputPanel id="panel2l"
                rendered="#{empty eventDetailsManagedBean.userId}">
                <p:dialog resizable="false" modal="true" dynamic="true"
                        position="center" id="loginDialog" widgetVar="loginDialog"
                        width="570" height="470">
                        <p:ajax event="close"
                                listener="#{customerManagedBean.handleClose}"
                                update="group" />
                        <ui:include src="loginDlg.xhtml" />
                </p:dialog>
        </p:outputPanel>
              
         </p:layoutUnit> 
          
      </p:layout>
       
      </h:form>
      </div>
      </div> 
    </ui:define>
    </ui:composition>
    </h:body>
</html>

