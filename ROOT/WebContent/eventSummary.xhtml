<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3c.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
        xmlns:pe="http://primefaces.org/ui/extensions">

<h:head>
	<title>Event Confirmation</title>
        
        <style type="text/css">
.customStyle .ui-state-default, .ui-widget-content .ui-state-default, .ui-widget-header .ui-state-default {
	background: none repeat scroll 0 0 #ffffff;
	color: #000000;
}
</style>
</h:head>
               

<h:body>
     <p:ajaxStatus onstart="PF('statusDialog').show();"
		onsuccess="PF('statusDialog').hide();" />
        
     <!--  <p:ajaxStatus onstart="PF('builoadL').show();" oncomplete="PF('builoadL').hide();" onsuccess="PF('builoadL').hide();"/>
-->
	<p:dialog modal="true" widgetVar="statusDialog" draggable="false"
                  closable="false" showHeader="false">
		<p:graphicImage value="/images/progress_bar.GIF" />
	</p:dialog>
	<ui:composition template="/template/user/commonLayout.xhtml">
		<ui:define name="content">
			<div class="content-bg clear-both">

				<!--lt-flap starts-->
				<div class="lt-flap">
					<img src="images/left.png" />
				</div>
				<!--lt-flap ends-->

				<!--messag-heart starts-->
				<div class="flap-mid">
					<div class="black-shade">
						<div class="clear home">
							<!--Home &gt; &#160; Welcome #{customerManagedBean.customerInfo.firstname}-->
							<span></span>&#160;
						</div>
					</div>
				</div>
				<!--messag-heart ends-->

				<!--rt-flap starts-->
				<div class="rt-flap">
					<img src="images/right.png" />
				</div>
				<!--rt-flap ends-->

				<div class="clear">
					<!--mid contents starts-->
					<div class="mid-content">
						<!--select details starts-->
						<div class="clear">
							<h1 id="h1title">
								Selected&#160;<span>#{eventDetailsManagedBean.eventType}</span>&#160;Options
							</h1>
						</div>
						<!--select details ends-->
						<div class="clear">
							<!--details head starts-->
							<div class="box-nav1 active" id="divdetails">1.Enter
								Requirements</div>
							<!--details head ends-->
							<!--summary head starts-->
							<div class="box-nav2 active" id="divsummary">2.Select
								Vendor Packages</div>
							<!--summary head ends-->
							<!--Payment head starts-->
							<div class="box-nav3 active" id="divpayment">3.Review and
								Confirm</div>
							<!--Payment head ends-->
						</div>

						<h:form id="frm">

							<!--details starts-->
							<div class="content_one" id="maindiv2">
								<!--details ends-->
								<!--summary details left panel starts-->
								<div class="left">
									<!--summary lt-panel starts-->
									<div class="summary_container_one">
										<div class="evleftbar">
											<p:accordionPanel style="background: #a87878;" id="ap"
												activeIndex="0,1,2">
												<p:tab titleStyleClass="tabttitle" id="evntDts"
													title="Event Details">

													<table class="sideBarForm2">
														<tr>
															<th style="font-weight: bold;">Event Date:</th>
															<td><h:outputText
																	value="#{eventDetailsManagedBean.eventDate}">
																	<f:convertDateTime pattern="dd-MM-yyyy" />
																</h:outputText></td>
														</tr>
														<tr class="hr-line-dot">
															<th style="font-weight: bold;">Location:</th>
															<td>#{eventDetailsManagedBean.areaName},
																#{eventDetailsManagedBean.cityName}</td>
														</tr>
														<tr class="hr-line-dot">
															<th style="font-weight: bold;">Venue Type:</th>
															<td>#{eventDetailsManagedBean.venueType}</td>
														</tr>
														<tr class="hr-line-dot">
															<th style="font-weight: bold;">Guests:</th>
															<td>#{eventDetailsManagedBean.totalCount}</td>
														</tr>
													</table>
												</p:tab>


												<p:tab titleStyleClass="tabttitle" id="srvRqst"
													title="Service Request">
													<div id="divWhere">
														<div class="where-cont-new">
															<!--When head starts-->
															<div class="grey-box-new">Venue</div>
															<!--When head ends-->
															<table class="sideBarForm2">
																<c:forEach
																	items="#{eventDetailsManagedBean.finalVenueMap.entrySet().toArray()}"
																	var="venue" varStatus="stVenue">
																	<c:forEach items="#{venue.value}" var="finalVenueD">
																		<tr>
																			<th colspan="2">#{finalVenueD.key}</th>
																		</tr>																		
																		<tr>
																			<td><h:outputText value="Cost: " /></td>
																			<td class="elementAmtStyle">Rs. #{eventDetailsManagedBean.getCost(finalVenueD.value.finalAmount)}</td>
																		</tr>
																		<tr>
																			<td><h:outputText rendered="#{!(finalVenueD.value.tax eq 0)}"
																					value="Tax (#{finalVenueD.value.tax}%): " /></td>
																			<td class="elementAmtStyle"><h:outputText rendered="#{!(finalVenueD.value.tax eq 0)}"
																					value="Rs. #{eventDetailsManagedBean.getVenueServiceCost(finalVenueD.value)} " />
																			</td>
																		</tr>
																	</c:forEach>
																</c:forEach>
															</table>
															<ui:repeat
																value="#{eventDetailsManagedBean.selectedSrvList}"
																var="event" varStatus="st">
																<div class="grey-box-new">#{event.heading}:</div>
																<table class="sideBarForm2">
																	<ui:repeat
																		value="#{eventDetailsManagedBean.finalServicesMap.entrySet().toArray()}"
																		var="service" varStatus="stService">
																		<ui:fragment rendered="#{event.id eq service.key}">
																			<tr>
																				<th colspan="2">#{service.value.serviceProviderName}</th>
																			</tr>
																			<tr>
																				<td><h:outputText value="Cost: " /></td>
																				<td class="elementAmtStyle"><h:outputText 
																						value="Rs. #{eventDetailsManagedBean.getProjectedCost(service.value.finalAmount,
																					service.value.unitOfCost)}" /></td>
																			</tr>
																			<tr>
																				<td><h:outputText
																						value="Tax (#{service.value.tax}%): " rendered="#{!(service.value.tax eq 0)}" /></td>
																				<td class="elementAmtStyle"><h:outputText rendered="#{!(service.value.tax eq 0)}"
																						value="Rs. #{eventDetailsManagedBean.getTotalServiceCost(service.value)}" /></td>
																			</tr>
																		</ui:fragment>
																	</ui:repeat>
																</table>
															</ui:repeat>
														</div>
													</div>
												</p:tab>
												<p:tab titleStyleClass="tabttitle" id="totalTab"
													title="Total">
													<table class="sideBarForm2">
														<tr>
															<th>Total Charges:</th>															
															<td class="elementAmtStyle">Rs. 
																#{eventDetailsManagedBean.totalCharge()}</td>
														</tr>
														<tr class="hr-line-dot">
															<th>Service Charges (8%):</th>															
															<td class="elementAmtStyle">Rs. 
																#{eventDetailsManagedBean.getServiceCharges()}</td>
														</tr>
                                                        <tr class="hr-line-dot">
															<th>Service Tax (12.36%):</th>															
															<td class="elementAmtStyle">Rs. 
																#{eventDetailsManagedBean.getServiceTaxes()}</td>
														</tr>
														<tr class="hr-line-dot">
															<th>Total Amount:</th>															
															<td class="elementAmtStyle">Rs. 
																#{eventDetailsManagedBean.getTotalAmountCharge()}</td>
														</tr>
													</table>
												</p:tab>
											</p:accordionPanel>
										</div>
										<!--summary details left panel ends-->

										<div class="evrightbar">
											<h2 style="padding-top: 5px;">#{eventDetailsManagedBean.eventType}
												event package details</h2>
											<br />
											<div class="hr-line-solid">
												<h:panelGroup
													rendered="#{eventDetailsManagedBean.finalVenueMap.size()!= 0}">
													<div class="bd_pack_ven">
														<div class="ev_rt_venue">
															<span>Venue</span>
															<h:commandLink styleClass="commandlink" style="font-family: Century Gothic;font-size:14px;"
																action="#{eventDetailsManagedBean.changeScreen(0)}"
																value="Change Venue">
																<f:param name="selectedBCService" value="Venue" />
															</h:commandLink>
														</div>
														<div class="bd_ven_content">
															<c:forEach
																items="#{eventDetailsManagedBean.finalVenueMap.entrySet().toArray()}"
																var="venue" varStatus="stVenue">
																<c:forEach items="#{venue.value}" var="finalVenueD">
																	<p:graphicImage height="100px" width="100px"
																		id="slider#{st.count}"
																		value="#{eventDetailsManagedBean.getHotelImagesSm(finalVenueD.value.venueId).get(0)}" />
																	<p:spacer width="20px" height="100px"></p:spacer>
																	<div class="bd_all_content">
																		<h3>#{finalVenueD.key}</h3>
																		<p>
																			<span>Address:</span>
																			#{eventDetailsManagedBean.getAddress(finalVenueD.value.venueId).addressId.addressLine1},
																			#{eventDetailsManagedBean.summaryVenueInfo.addressId.addressLine2}
																		</p>
																		<div class="booked">
																			<p>
																				Booked for <span>
																					<p>#{eventDetailsManagedBean.hallLocalMap.get(eventDetailsManagedBean.selHall).hallName}</p>
																					<h:outputText
																						value="#{eventDetailsManagedBean.eventDate}"
																						id="popupButtonDate">
																						<f:convertDateTime pattern="dd-MM-yyyy" />
																					</h:outputText>
																				</span> from<span> 9am - 11am </span>
																			</p>
																			<!--<p>#{eventDetailsManagedBean.summaryVenueInfo.venueDesc}</p>-->

																		</div>
																		<br />
																		<div>Package: #{finalVenueD.value.packageName}</div>
																		<p:spacer width="500px" height="15px" />
																	</div>
																</c:forEach>
															</c:forEach>
														</div>
													</div>
												</h:panelGroup>
												<c:forEach
													items="#{eventDetailsManagedBean.allSelectedServicesMap}"
													varStatus="stat" var="allS">

													<c:forEach
														items="#{eventDetailsManagedBean.finalServicesMap.entrySet().toArray()}"
														var="finalV">
														<ui:fragment rendered="#{allS.key.getId() eq finalV.key}">
															<div class="bd_pack_ven">
																<div class="ev_rt_venue">
																	<span>#{allS.key.getHeading()}</span>
																	<h:commandLink styleClass="commandlink" style="font-family: Century Gothic;font-size:14px;"
																		action="#{eventDetailsManagedBean.changeScreen(stat.count)}"
																		value="Change #{allS.key.getHeading()}">
																		<f:param name="selectedBCService"
																			value="#{allS.key.getId()}" />
																	</h:commandLink>
																</div>
																<div class="bd_ven_content">
																	<p:graphicImage height="100px" width="100px"
																		value="#{eventDetailsManagedBean.getServiceImagesSm(finalV.value.serviceProviderId).get(0)}" />
																	<p:spacer width="20px" height="100px"></p:spacer>
																	<div class="bd_all_content">
																		<h3>#{finalV.value.serviceProviderName}</h3>
																		<p>
																			<span>Address:</span>
																			#{eventDetailsManagedBean.getSpAddress(finalV.value.serviceProviderId).addressId.addressLine1},
																			#{eventDetailsManagedBean.summarySpInfo.addressId.addressLine2}
																		</p>
																		<div class="booked">
																			<p>Booked on</p>
																			<p>
																				<h:outputText
																					value="#{eventDetailsManagedBean.eventDate}"
																					class="popupButtonDate">
																					<f:convertDateTime pattern="dd-MM-yyyy" />
																				</h:outputText>
																			</p>
																			<br />
																			<div>Package: #{finalV.value.packageName}</div>
																			<p:spacer width="500px" height="15px" />
																		</div>

																	</div>
																</div>

															</div>
														</ui:fragment>
													</c:forEach>
												</c:forEach>
											</div>

											<p:outputPanel id="panel1"
												rendered="#{empty eventDetailsManagedBean.userId}">
												<p:dialog resizable="false" modal="true" dynamic="true"
													position="center" id="eventDialog" widgetVar="eventDialog"
													width="570" height="470">
													<ui:include src="customerRegDlg.xhtml" />
												</p:dialog>
											</p:outputPanel>
											<p:outputPanel id="panel2"
												rendered="#{empty eventDetailsManagedBean.userId}">
												<p:dialog resizable="false" modal="true" dynamic="true"  position="center"
													id="loginDialog" widgetVar="loginDialog"
													width="570" height="470" >
													<p:ajax event="close" listener="#{customerManagedBean.handleClose}" update="group" />
													<ui:include src="loginDlg.xhtml" />
												</p:dialog>
											</p:outputPanel>
											<br />

											<h:panelGroup
												rendered="#{eventDetailsManagedBean.finalVenueMap.size()== 0 &amp;&amp; eventDetailsManagedBean.finalServicesMap.size() == 0}">
												<p:panel>No Venue and Services selected. Please click on Edit button to add venue and services. <br />
													<br />
													<p:commandButton styleClass="nextStepButton1 buttonStyle"
														style="float:right;"
														action="#{eventDetailsManagedBean.changeScreen(0)}"
														value="Edit">
														<f:param name="selectedBCService" value="Venue" />
													</p:commandButton>
													<p:commandButton immediate="true" id="imgbtnnext1C1"
														styleClass="nextStepButton1"
														style="float:right;" onclick="cancelConfirmation.show()"
														value="Cancel">
													</p:commandButton>
													<br /><br /><br />														
												</p:panel>
											</h:panelGroup>
											<h:panelGroup
												rendered="#{eventDetailsManagedBean.finalVenueMap.size()!= 0 || eventDetailsManagedBean.finalServicesMap.size()!= 0}">

												<h:panelGroup
													rendered="#{eventDetailsManagedBean.userId==null || empty eventDetailsManagedBean.userId}">
													<p:commandButton styleClass="nextStepButton1 buttonStyle"
														style="float:right;width: 250px !important;" onclick="loginDialog.show()"
														id="submit1" value="Get Final Quote" label="Submit">
													</p:commandButton>
													<p:confirmDialog widgetVar="confirmation" closable="false"
														header="Register"
														message="Please Register to submit the details"
														global="true" showEffect="fade" hideEffect="explode">
														<p:commandButton value="Register"
															action="#{eventDetailsManagedBean.loginForm}"
															styleClass="ui-confirmdialog-yes" icon="ui-icon-check"
															oncomplete="loginDialog.show()" />
													</p:confirmDialog>
												</h:panelGroup>

												<h:panelGroup
													rendered="#{eventDetailsManagedBean.userId!=null || not empty eventDetailsManagedBean.userId}">
													<p:commandButton styleClass="nextStepButton1 buttonStyle"
														style="float:right;width: 250px !important;" immediate="true" id="submit"
														value="Get Final Quote"
														action="#{eventDetailsManagedBean.insertEvent}" onstart="PF('blockUIWidget').block()" oncomplete="PF('blockUIWidget').unblock()">
													</p:commandButton>
                                                                                                    <p:commandButton styleClass="nextStepButton1 buttonStyle"
														style="float:right;width: 250px !important;" immediate="true" id="submitDraft"
														value="Save Draft"
														action="#{eventDetailsManagedBean.saveDraft}" onstart="PF('blockUIWidget').block()" oncomplete="PF('blockUIWidget').unblock()">
													</p:commandButton>
													<p:commandButton immediate="true" id="imgbtnnext1C2"
														styleClass="nextStepButton1"
														style="float:right;margin-top:10px;" onclick="cancelConfirmation.show()"
														value="Cancel">
													</p:commandButton>
												</h:panelGroup>
                                                                                            
                                                                                             <pe:blockUI id="blockUIWidget" widgetVar="blockUIWidget" >  
                                                                                                      <p:graphicImage value="/images/progress_bar.GIF" />  
                                                                                                    </pe:blockUI>
												<ui:remove>
													<p:commandButton id="Chk" label="Submit"
														value="Confirmation"
														action="#{eventDetailsManagedBean.chkEvent}">
														<f:param name="eventId"
															value="#{eventDetailsManagedBean.eventId}" />
													</p:commandButton>
												</ui:remove>

											</h:panelGroup>

											<p:confirmDialog widgetVar="cancelConfirmation"
												closable="false" header="Cancel Session"
												message="Are You Sure you want to cancel the session"
												showEffect="fade" hideEffect="explode">
												<p:commandButton value="Yes" ajax="true"
													action="#{eventDetailsManagedBean.goLoginPage}"
													styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
												<p:commandButton type="button" value="No"
													onclick="cancelConfirmation.hide()"
													styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
											</p:confirmDialog>

										</div>
									</div>
								</div>
							</div>
						</h:form>
					</div>
					<!--icons starts-->
					<div style="float: right; width: 63px; margin-top: 30px;">
						<a href="contact.jsf"><img
							src="images/icon2.png" border="0" /></a>
					</div>
					<!--icons ends-->
				</div>
				<div class="clear"></div>

			</div>

		</ui:define>

	</ui:composition>
    
    <script type="text/javascript">           
       
        
        body.onbeforeunload = function() {
    return 'Are you sure you want to navigate away from this page?';
};
        </script>
</h:body>
</html>

